# 연관관계 매핑 3가지 고려사항
---
1. 다중성
- 다대일
- 일대다
- 일대일
- 다대다
2. 방향
- 단방향
- 양방향
3. 연관관계의 주인
- 외래 키 관리는 연관간계의 주인이 함
- 반대편은 `mappedBy` 옵션 사용

<br>

# 다대일
---
단방향 연관관계를 매핑할 때는, 외래 키 관리하는 엔티티에만 필드 선언


양방향 연관관계를 매핑할 때는, 앞서 말했듯이 `mappedBy`사용

<br>

# 일대일
---
일대일 관계는 양쪽이 서로 하나의 관계만 가지는 것을 말한다.

1. 주 테이블에 외래 키
학생과 사물함이 존재할 때, 주 테이블은 학생이 되는데 이 방법은 객체지향 개발자들이 선호하는 방법이다.
2. 대상 테이블에 외래 키
사물함에 외래 키를 지정하는 것은 대상 테이블에 외래 키를 지정하는 것인데, 이것은 JPA에서는 지원하지 않기 떄문에 양방향으로 바꿔준다.

`사물함을 주 테이블로 간주하면 안될까?`


<br>

# 다대다
---
학생과 상품 엔티티가 존재하면 다음과 같은 상황이 발생한다.
1. 학생들은 다양한 상품을 주문할 수 있다.
2. 상품들은 다양한 학생들에게 팔릴 수 있다.

이렇게 되면, 학생과 상품 엔티티는 다대다 관계가 만들어진다. 이 때, 다대다를 매핑할 수 있는 방법은 두 가지가 있다.
1. 학생 pk와 상품 pk를 복합키로 사용한다.
- `@IdClass @EmbeddedId`를 사용해서 식별자 클래스를 만듦
2. 어떤 엔티티와도 관계없는 새로운 id를 생성한다.

`복합키를 사용하게 되면 처리해야할 일이 증가하고, 식별자 클래스에 equals, hashCode를 직접 구현해야 하며, 식별자 클래스도 따로 만들어야 한다. 따라서 더욱 간단하고 직관적인 2번 방법으로 @ManyToMany를 일대다 다대일로 풀어내는 엔티티를 만들어주자`

<br>

# 결론
---
**식별자를 사용하여 기본 키를 구성하는 `식별 관계`보다는 식별자는 외래 키로만 사용하고 새롭게 기본 키를 구성하는 `비식별 관계`를 사용하도록 하자.**