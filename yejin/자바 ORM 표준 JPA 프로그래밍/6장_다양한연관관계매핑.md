### ê°€ëŠ¥í•œ ì—°ê´€ê´€ê³„

(ì™¼ìª½ì„ ì—°ê´€ê´€ê³„ ì£¼ì¸ì´ë¼ê³  ê°€ì •)

- **ë‹¤ëŒ€ì¼:** ë‹¨ë°©í–¥, ì–‘ë°©í–¥
- **ì¼ëŒ€ë‹¤**: ë‹¨ë°©í–¥, ì–‘ë°©í–¥
- **ì¼ëŒ€ì¼**: ì£¼ í…Œì´ë¸” ë‹¨ë°©í–¥, ì–‘ë°©í–¥
- **ì¼ëŒ€ì¼**: ëŒ€ìƒ í…Œì´ë¸” ë‹¨ë°©í–¥, ì–‘ë°©í–¥
- **ë‹¤ëŒ€ë‹¤**: ë‹¨ë°©í–¥, ì–‘ë°©í–¥


<br>
<br>

## ë‹¤ëŒ€ì¼

Member(ë‹¤ - ì™¸ë˜í‚¤ ê´€ë¦¬) -  Team(ì¼)

### ë‹¨ë°©í–¥

- íšŒì›ì—ì„œ íŒ€ ì—”í‹°í‹° ì°¸ì¡° ê°€ëŠ¥ / íŒ€ì—ì„œ íšŒì› ì—”í‹°í‹° ì°¸ì¡° ë¶ˆê°€ëŠ¥
- Member.team í•„ë“œë¡œ íšŒì› í…Œì´ë¸”ì˜ TEAM_ID ì™¸ë˜í‚¤ ê´€ë¦¬

```java
@Entity
public class Member {
		
		@Id @GeneratedValue
		@Column(name = "MEMBER_ID")
		private Long id;

		private String username;

		@ManyToOne
		@JoinColumn(name = "TEAM_ID")
		private Team team;
}

```

```java
@Entity
public class Team {

		@Id @GeneratedValue
		@Column(name = "TEAM_ID")
		private Long id;

		private String name;
}
```

### ì–‘ë°©í–¥

- ì„œë¡œ ì°¸ì¡°
- ì—°ê´€ê´€ê³„ (í¸ì˜) ë©”ì„œë“œ ì‚¬ìš© ì‹œ ë¬´í•œë£¨í”„ì— ë¹ ì§€ì§€ ì•Šë„ë¡ ì£¼ì˜

```java
public class Member {
		
		@Id @GeneratedValue
		@Column(name = "MEMBER_ID")
		private Long id;

		private String username;

		@ManyToOne
		@JoinColumn(name = "TEAM_ID")
		private Team team;

		public void setTeam(Team team) {
				this.team = team;

				// ë¬´í•œë£¨í”„ ì£¼ì˜
				if (!team.getMembers().contains(this) {
						team.getMembers().add(this)
				}
}
```

```java
@Entity
public class Team {

		@Id @GeneratedValue
		@Column(name = "TEAM_ID")
		private Long id;

		private String name;

		@OneToMany(mappedBy = "team")
		List<Member> members = new ArrayList<>();

		public void addMember(Member member) {
				this.members.add(member);
				
				// ë¬´í•œë£¨í”„ ì£¼ì˜
				if (member.getTeam() != this) {
						member.setTeam(this);
				}
		}
}
```

<br>

## ì¼ëŒ€ë‹¤

Team(ì¼ - ì™¸ë˜í‚¤ ê´€ë¦¬) - Member(ë‹¤)

<aside>
ğŸ’¡ **@JoinColumnì´ ì—†ìœ¼ë©´** JPAëŠ” ì—°ê²° í…Œì´ë¸”ì„ ì¤‘ê°„ì— ë‘ê³  ì—°ê´€ê´€ê³„ë¥¼ ê´€ë¦¬í•˜ëŠ” ì¡°ì¸ í…Œì´ë¸” ì „ëµì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•´ì„œ ë§¤í•‘


</aside>

### ë‹¨ë°©í–¥

```java
@Entity
public class Team {
		
		@Id @GeneratedValue
		@Column(name = "TEAM_ID")
		private Long id;

		private String name;

		@OneToMany
		@JoinColumn(name = "TEAM_ID")  // ë§¤í•‘í•  ì™¸ë˜í‚¤
		private List<Member> members = new ArrayList<Member>();
}

```

- ìì‹  í…Œì´ë¸”ì— ì™¸ë˜í‚¤ê°€ ì—†ìœ¼ë¯€ë¡œ ì—”í‹°í‹° ì €ì¥ì‹œ UPDATE SQLì„ ì¶”ê°€ë¡œ ì‹¤í–‰í•´ì•¼ í•¨

  ```java
  public void save() {
  	
  		Member member1 = new Member("member1");  
  		Member member2 = new Member("member2");
  
  		Team team1 = new Team("team1");
  		team1.getMembers().add(member1);
  		team1.getMembers().add(member2);
  
  		em.persist(member1);  // insert member1. (TEAM_IDì— null ì €ì¥)
  		em.persist(member2);  // insert member2
  		em.persist(team1);    // insert team1, update member1, update member2
  
  		transaction.commit();
  }
  ```

  â‡’ ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ ë§¤í•‘ë³´ë‹¤ ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ ë§¤í•‘ ì‚¬ìš© ê¶Œì¥
  
<br>

## ì¼ëŒ€ì¼

- ì£¼ í…Œì´ë¸”ì´ë‚˜ ëŒ€ìƒ í…Œì´ë¸” ì¤‘ ì–´ëŠ ê³³ì´ë‚˜ ì™¸ë˜ í‚¤ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.

<aside>
ğŸ’¡ **ì£¼ í…Œì´ë¸” :** ë¹„ì¦ˆë‹ˆìŠ¤ ê´€ì ì—ì„œ ì¡°íšŒë¥¼ ë” ë§ì´ í•˜ëŠ” ìª½, ì™¸ë˜ í‚¤ë¥¼ ê°€ì§


</aside>

MEMBER(ì£¼ í…Œì´ë¸”) - LOCKER(ëŒ€ìƒ í…Œì´ë¸”)

### ë‹¨ë°©í–¥

```java
@Entity
public class Member {
		
		@Id @GeneratedValue
		@Column(name = "MEMBER_ID"
		private Long id;

		private String username;

		@OneToOne
		@JoinColumn("LOCKER_ID")
		private Locker locker;
}
```

```java
@Entity
public class Locker {

		@Id @GeneratedValue
		@Column(name = "LOCKER_ID"
		private Long id;

		private String name;
}
```

### ì–‘ë°©í–¥

```java
@Entity
public class Member {
		
		@Id @GeneratedValue
		@Column(name = "MEMBER_ID"
		private Long id;

		private String username;

		@OneToOne
		@JoinColumn("LOCKER_ID")
		private Locker locker;
}
```

```java
@Entity
public class Locker {

		@Id @GeneratedValue
		@Column(name = "LOCKER_ID"
		private Long id;

		private String name;

		@OneToOne(mappedBy = "locker")
		private Member member;
}
```

<br>


## ë‹¤ëŒ€ë‹¤

- ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì •ê·œí™”ëœ í…Œì´ë¸” 2ê°œë¡œ ë‹¤ëŒ€ë‹¤ ê´€ê³„ X â†’ ì—°ê²° í…Œì´ë¸” ì¶”ê°€í•´ì•¼ í•¨
- ê°ì²´ëŠ” ë‹¤ëŒ€ë‹¤ í‘œí˜„ ê°€ëŠ¥

### ì—°ê²° í…Œì´ë¸”(MEMBER_PRODUCT) ì—†ì´ ë§¤í•‘

- ì—°ê²° í…Œì´ë¸”ì— ì¹¼ëŸ¼ì„ ì¶”ê°€í•  ìˆ˜ ì—†ë‹¤. (ì—°ê²° í…Œì´ë¸” ë”°ë¡œ ìƒì„± í•´ì•¼ í•¨)

ë‹¨ë°©í–¥

```java
@Entity
public class Member {
		
		@Id @Column(name = "MEMBER_ID")
		private String id;

		private String username;

		@ManyToMany
		@JoinTable(name = "MEMBER_PRODUCT", 
								joinColumns = @JoinColumn(name = "MEMBER_ID"),
								inverseJoinColumn = @JoinColumn(name = "PRODUCT_ID")
		private List<Product> products = new ArrayList<Product>();
}
```

```java
@Entity
public class Product {
		
		@Id @Column(name = "PRODUCT_ID")
		private String id;

		private String name;
}
```

ì–‘ë°©í–¥

```java
@Entity
public class Product {
		
		@Id @Column(name = "PRODUCT_ID")
		private String id;

		private String name;

		@ManyToMany(mappedBy = "products")
		private List<Member> members;
}
```
### ì—°ê²° í…Œì´ë¸” ìƒì„±ì‹œ PK êµ¬ì„± ë°©ë²•

- ì‹ë³„ ê´€ê³„ : ë°›ì•„ì˜¨ ì‹ë³„ìë¥¼ ê¸°ë³¸ í‚¤ + ì™¸ë˜ í‚¤ë¡œ ì‚¬ìš©
- ë¹„ì‹ë³„ ê´€ê³„ : ìƒˆë¡œìš´ ì‹ë³„ì ì¶”ê°€ (ë‹¨ìˆœ, í¸ë¦¬)
