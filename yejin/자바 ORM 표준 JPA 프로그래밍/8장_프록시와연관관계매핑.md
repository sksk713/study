## í”„ë¡ì‹œ

### í”„ë¡ì‹œ ê°ì²´

ì¡°íšŒë¥¼ ì§€ì—°ì‹œí‚¤ëŠ” ê°€ì§œ ê°ì²´, ì‹¤ì œ ê°ì²´ì— ëŒ€í•œ ì°¸ì¡° ë³´ê´€

- ì²˜ìŒ ì‚¬ìš©í•  ë•Œ í•œ ë²ˆë§Œ ì´ˆê¸°í™”

- ì´ˆê¸°í™” í›„ í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ì„œ ì‹¤ì œ ì—”í‹°í‹°ì— ì ‘ê·¼

- í”„ë¡ì‹œ ê°ì²´ì—ì„œ ì‹ë³„ì ê°’ì„ ì¡°íšŒ

  ```java
  Team team = em.getReference(Team.class, "team1");  // ì‹ë³„ì ë³´ê´€
  team.getId();  // ì´ˆê¸°í™”?
  ```

  - ì—”í‹°í‹° ì ‘ê·¼ ë°©ì‹ì„ í”„ë¡œí¼í‹°ë¡œ ì„¤ì •í•œ ê²½ìš° - ì´ˆê¸°í™”í•˜ì§€ ì•ŠìŒ
  - ì—”í‹°í‹° ì ‘ê·¼ ë°©ì‹ì„ í•„ë“œë¡œ ì„¤ì •í•œ ê²½ìš° - ì´ˆê¸°í™”

### ì¦‰ì‹œ ë¡œë”©ê³¼ ì§€ì—° ë¡œë”©

- ì¦‰ì‹œ ë¡œë”© : ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•  ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë„ í•¨ê»˜ ì¡°íšŒ

  - ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ ì¦‰ì‹œ ì¡°íšŒ. í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” ê°€ëŠ¥í•˜ë©´ SQL ì¡°ì¸ì„ ì‚¬ìš©í•´ì„œ í•œ ë²ˆì— ì¡°íšŒ

  <aside>
  ğŸ’¡ nullable ì„¤ì •ì— ë”°ë¥¸ ì¡°ì¸ ì „ëµ
  - @JoinColumn(nullable=true) : NULL í—ˆìš©(ê¸°ë³¸ê°’), ì™¸ë¶€ ì¡°ì¸ ì‚¬ìš©
  - @JoinColumn(nullable=false) : NULL í—ˆìš©í•˜ì§€ ì•ŠìŒ, ë‚´ë¶€ ì¡°ì¸ ì‚¬ìš©


  ì™¸ë¶€ ì¡°ì¸ë³´ë‹¤ ë‚´ë¶€ ì¡°ì¸ì´ ì„±ëŠ¥ ìµœì í™”ì— ìœ ë¦¬í•˜ë‹¤. ì™¸ë˜ í‚¤ì— NULL ê°’ì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ @JoinColumn(nullable=false)ë¡œ ì„¤ì •í•˜ì

  </aside>

- ì§€ì—° ë¡œë”© : ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ ì‹¤ì œ ì‚¬ìš©í•  ë•Œ ì¡°íšŒ (ì—”í‹°í‹°ê°€ ì‹¤ì œ ì‚¬ìš©ë  ë•Œê¹Œì§€ ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ ì§€ì—°)

  - ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ í”„ë¡ì‹œë¡œ ì¡°íšŒ. í”„ë¡ì‹œë¥¼ ì‹¤ì œ ì‚¬ìš©í•  ë•Œ ì´ˆê¸°í™”í•˜ë©´ì„œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°íšŒí•œë‹¤.

  ```java
  Member member = em.find(Member.class, "member1");
  Team team = member.getTeam();  // í”„ë¡ì‹œ ê°ì²´
  team.getName();  // íŒ€ ê°ì²´ ì‹¤ì œ ì‚¬ìš© (í”„ë¡ì‹œ ê°ì²´ ì´ˆê¸°í™”)
  ```

- JPA ê¸°ë³¸ í˜ì¹˜ ì „ëµ

  - `@ManyToOne`, `@OneToOne` : ì¦‰ì‹œ ë¡œë”©
  - `@OneToMany`, `@ManyToMany` : ì§€ì—° ë¡œë”©
  - ëª¨ë“  ì—°ê´€ê´€ê³„ì— ì§€ì—° ë¡œë”© ì‚¬ìš© ì¶”ì²œ, í•„ìš”í•œ ê³³ì—ë§Œ ì¦‰ì‹œ ë¡œë”©ì„ ì‚¬ìš©í•˜ë„ë¡ ìµœì í™”

<br>
<br>


## ì˜ì†ì„± ì „ì´: CASCADE

íŠ¹ì • ì—”í‹°í‹°ë¥¼ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë„ í•¨ê»˜ ì˜ì† ìƒíƒœë¡œ ë§Œë“¦

- ì—°ê´€ê´€ê³„ ë§¤í•‘ê³¼ ê´€ë ¨ ì—†ìŒ
- ì—”í‹°í‹°ë¥¼ ì˜ì†í™”í™œ ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë„ ê°™ì´ ì˜ì†í™”í•˜ëŠ” í¸ë¦¬í•¨ ì œê³µ

### ì €ì¥

ì˜ì†ì„± ì‚¬ìš© X

```java
Parent parent = new Parent();
em.persist(parent);

Child child1 = new Child();
child1.setParent(parent);  
parent.getChildren().add(child1);
em.persist(child1)

Child child2 = new Child();
child2.setParent(parent);  
parent.getChildren().add(child2);
em.persist(child2)
```

ì˜ì†ì„± ì‚¬ìš© O

```java
@Entity
public class Parent {
		
		@OneToMany(mappedBy = "parent", cascade = CascadeType.PERSIST)
		private List<Child> children = new ArrayList<>();
}
```

```java
Parent parent = new Parent();

Child child1 = new Child();
child1.setParent(parent);  
parent.getChildren().add(child1);

Child child2 = new Child();
child2.setParent(parent);  
parent.getChildren().add(child2);

em.persist(parent);
```

### ì‚­ì œ

ì˜ì†ì„± ì‚¬ìš© X

```java
Parent findParent = em.find(Parent.class, 1L);
Child findChild1 = em.find(Child.class, 1L);
Child findChild2 = em.find(Child.class, 2L);

em.remove(findParent);
em.remove(findChild1);
em.remove(findChild2);
```

ì˜ì†ì„± ì‚¬ìš© O

```java
Parent findParent = em.find(Parent.class, 1L);
Child findChild1 = em.find(Child.class, 1L);
Child findChild2 = em.find(Child.class, 2L);

em.remove(findParent);
```

<br>
<br>

## ê³ ì•„ ê°ì²´ ì œê±°

ë¶€ëª¨ ì—”í‹°í‹°ì™€ ì—°ê´€ê´€ê³„ê°€ ëŠì–´ì§„ ìì‹ ì—”í‹°í‹°ë¥¼ ìë™ìœ¼ë¡œ ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥

```java
@OneToMany(mappedBy = "parent", orphanRemoval = true)
private List<Child> children = new ArrayList<>();
```

